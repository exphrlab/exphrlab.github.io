<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Join Our Study · EXPHR Lab</title>
  <link rel="stylesheet" href="./assets/style.css?v=17">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="text-slate-800 antialiased">
  <!-- Header -->
  <header role="banner" class="sticky top-0 z-50 bg-white/90 backdrop-blur border-b border-slate-200" overflow-visible>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-14 md:h-16" overflow-visible>
      <nav aria-label="Primary" class="flex items-center justify-between h-full" overflow-visible>
        <!-- Left: Brand -->
        <img
              src="assets/media/lab-logo-2.png"
              alt="EXPHR Lab"
              class="h-10 md:h-12 lg:h-14 w-auto object-contain"
              loading="eager"
            />
            <div class="flex items-center gap-2 md:gap-3 min-w-0">
              <a href="/index.html" class="flex items-center gap-3 md:gap-4 min-w-0 hover:opacity-80 transition-opacity">
            <span class="font-semibold tracking-tight whitespace-nowrap text-slate-900 text-base sm:text-lg">EXPHR Lab</span>
            
        </a>

        <!-- Right: Menu Links -->
        <div class="flex flex-nowrap items-center gap-5 sm:gap-6 md:gap-7 lg:gap-9 whitespace-nowrap overflow-x-auto overflow-y-visible [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden py-2 md:py-0 ml-6 md:ml-10">
          <a href="/index.html" class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative group shrink-0">
            <span class="relative">Home</span>
            <span class="absolute -bottom-1 left-0 w-0 h-[2px] bg-accent-blue transition-all group-hover:w-full"></span>
          </a>
          <a href="/people.html" class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative group shrink-0">
            <span class="relative">Our Team</span>
            <span class="absolute -bottom-1 left-0 w-0 h-[2px] bg-accent-blue transition-all group-hover:w-full"></span>
          </a>
          <a href="/projects.html" class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative group shrink-0">
            <span class="relative">Projects</span>
            <span class="absolute -bottom-1 left-0 w-0 h-[2px] bg-accent-blue transition-all group-hover:w-full"></span>
          </a>
          <a href="/publications.html" class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative group shrink-0">
            <span class="relative">Publications</span>
            <span class="absolute -bottom-1 left-0 w-0 h-[2px] bg-accent-blue transition-all group-hover:w-full"></span>
          </a>
          <!-- News & Highlights Dropdown -->
          <div class="relative shrink-0" id="news-dropdown-wrapper" style="z-index: 50;">
            <div class="flex items-center gap-0.5">
              <a 
                href="/news-highlights.html"
                class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 rounded px-1 whitespace-nowrap"
              >
                <span>News &amp; Highlights</span>
              </a>
              <button 
                type="button"
                id="news-dropdown-button"
                class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative flex items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 rounded px-1 shrink-0"
                aria-haspopup="menu"
                aria-expanded="false"
              >
                <svg id="news-chevron" class="w-3 h-3 transition-transform shrink-0 duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </button>
            </div>
            <div 
              id="news-dropdown" 
              class="absolute top-full left-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-slate-200 py-2 opacity-0 invisible pointer-events-none -translate-y-2 transition-all duration-200 ease-out z-50"
              role="menu"
            >
              <a href="/announcements.html" class="block px-4 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:underline focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:outline-none transition-colors" role="menuitem">Announcements</a>
            </div>
          </div>

          <a href="/lab-gallery.html" class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative group shrink-0 whitespace-nowrap">
            <span class="relative">Lab Gallery</span>
            <span class="absolute -bottom-1 left-0 w-0 h-[2px] bg-accent-blue transition-all group-hover:w-full"></span>
          </a>

          <!-- Contact Dropdown -->
          <div class="relative shrink-0 group" id="contact-dropdown-wrapper" style="z-index: 50;">
            <a 
              href="./contact.html"
              class="text-[13px] sm:text-[14px] md:text-[15px] font-medium text-slate-700 hover:text-slate-900 transition relative flex items-center gap-1 whitespace-nowrap"
            >
              <span>Contact</span>
              <svg class="w-3 h-3 transition-transform shrink-0 duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </a>
            <div 
              id="contact-dropdown" 
              class="absolute top-full left-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-slate-200 py-2 opacity-0 invisible pointer-events-none group-hover:opacity-100 group-hover:visible group-hover:pointer-events-auto group-focus-within:opacity-100 group-focus-within:visible group-focus-within:pointer-events-auto transition-all duration-200 ease-out z-50"
              role="menu"
            >
              <a href="./join-our-study.html" class="block px-4 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:underline focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:outline-none transition-colors" role="menuitem">Join Our Study</a>
              <div class="border-t border-slate-100 my-1"></div>
              <a href="./opportunities.html" class="block px-4 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:underline focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:outline-none transition-colors" role="menuitem">Opportunities</a>
              <div class="border-t border-slate-100 my-1"></div>
              <a href="./contact.html#form" class="block px-4 py-2 text-sm text-slate-700 hover:bg-gray-50 hover:underline focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:outline-none transition-colors" role="menuitem">Get In Touch</a>
            </div>
          </div>
        </nav>
    </div>
  </header>

  <main class="bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <!-- Header Section -->
      <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight text-slate-900 mb-4">
          Join Our Studies
        </h1>
        <p class="text-lg text-slate-600 max-w-2xl mx-auto">
          Emory School of Medicine
        </p>
      </div>

      <!-- Study Cards -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-16">
        <!-- ISTEP Card -->
        <div class="border rounded-xl bg-white shadow-sm p-6 relative flex flex-col hover:-translate-y-1 hover:shadow-md transition-all duration-200">
          <!-- Title -->
          <h2 class="text-2xl font-bold text-slate-900 mb-4">ISTEP</h2>

          <!-- Description -->
          <p class="text-slate-700 mb-6 leading-relaxed text-sm md:text-base flex-grow">
            Inspiring Seniors Toward Exercise Promotion (ISTEP) is a music-supported, habit-building physical activity program for midlife and older adults designed to improve brain and heart health.
          </p>

          <!-- Flyer Thumbnail -->
          <div class="mb-6">
            <img 
              src="assets/media/istep-flyer.jpg" 
              alt="ISTEP Study Flyer thumbnail" 
              onclick="openLightbox('assets/media/istep-flyer.jpg', 'ISTEP Study Flyer')"
              aria-label="View ISTEP flyer"
              role="button"
              tabindex="0"
              onkeydown="if(event.key === 'Enter') openLightbox('assets/media/istep-flyer.jpg', 'ISTEP Study Flyer')"
              class="w-full h-auto rounded-lg border border-slate-200 cursor-pointer hover:scale-105 hover:shadow-lg transition-all duration-300 max-w-full"
              loading="lazy"
              onerror="this.parentElement.style.display='none'"
            />
          </div>

          <!-- Buttons -->
          <div class="mb-6">
            <a 
              href="https://redcap.emory.edu/surveys/?s=8KTKWARLPKDW7EEA"
              target="_blank"
              rel="noopener noreferrer"
              class="block w-full px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-center font-medium hover:from-blue-600 hover:to-blue-700 transition-all duration-200"
            >
              Sign Up
            </a>
          </div>

          <!-- QR Code -->
          <div class="absolute bottom-4 right-4">
            <img 
              src="assets/media/istep-qr.png" 
              alt="ISTEP QR Code" 
              class="w-20 h-20 object-contain"
              onerror="this.style.display='none'"
            />
          </div>
        </div>

        <!-- TRAC Card -->
        <div class="border rounded-xl bg-white shadow-sm p-6 relative flex flex-col hover:-translate-y-1 hover:shadow-md transition-all duration-200">
          <!-- Title -->
          <h2 class="text-2xl font-bold text-slate-900 mb-4">TRAC</h2>

          <!-- Description -->
          <p class="text-slate-700 mb-6 leading-relaxed text-sm md:text-base flex-grow">
            TRAC investigates how exercise and daily behaviors support brain–cardio resilience, tracking cognitive and affective changes to understand mechanisms linking movement, mood, and long-term health.
          </p>

          <!-- Flyer Thumbnail -->
          <div class="mb-6">
            <img 
              src="assets/media/trac-flyer.jpg" 
              alt="TRAC Study Flyer thumbnail" 
              onclick="openLightbox('assets/media/trac-flyer.jpg', 'TRAC Study Flyer')"
              aria-label="View TRAC flyer"
              role="button"
              tabindex="0"
              onkeydown="if(event.key === 'Enter') openLightbox('assets/media/trac-flyer.jpg', 'TRAC Study Flyer')"
              class="w-full h-auto rounded-lg border border-slate-200 cursor-pointer hover:scale-105 hover:shadow-lg transition-all duration-300 max-w-full"
              loading="lazy"
              onerror="this.parentElement.style.display='none'"
            />
          </div>

          <!-- Buttons -->
          <div class="mb-6">
            <a 
              href="https://redcap.emory.edu/surveys/?s=8EHXNANLX3H8FWNC"
              target="_blank"
              rel="noopener noreferrer"
              class="block w-full px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg text-center font-medium hover:from-blue-600 hover:to-blue-700 transition-all duration-200"
            >
              Sign Up
            </a>
          </div>

          <!-- QR Code -->
          <div class="absolute bottom-4 right-4">
            <img 
              src="assets/media/trac-qr.png" 
              alt="TRAC QR Code" 
              class="w-20 h-20 object-contain"
              onerror="this.style.display='none'"
            />
          </div>
        </div>
      </div>

      <!-- Contact Cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <!-- Email Card -->
        <div class="border rounded-xl bg-white shadow-sm p-6">
          <h3 class="text-lg font-semibold text-slate-900 mb-2">Email</h3>
          <a href="mailto:istep@emory.edu" class="text-blue-700 hover:text-blue-800 hover:underline">
            istep@emory.edu
          </a>
        </div>

        <!-- Phone Card -->
        <div class="border rounded-xl bg-white shadow-sm p-6">
          <h3 class="text-lg font-semibold text-slate-900 mb-2">Phone</h3>
          <a href="tel:+14047278919" class="text-blue-700 hover:text-blue-800 hover:underline">
            404-727-8919
          </a>
        </div>
      </div>

      <!-- Footer Text -->
      <p class="text-center text-sm text-slate-600">
        Questions? Contact us.
      </p>
    </div>
  </main>

  <!-- Footer -->
  <footer class="border-t mt-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-sm text-slate-600">
      © 2025 EXPHR Lab · Emory University
    </div>
  </footer>

  <!-- Lightbox Modal -->
  <div 
    id="lightbox" 
    class="fixed inset-0 z-50 hidden items-center justify-center bg-black/80 backdrop-blur-sm"
    role="dialog"
    aria-modal="true"
    aria-labelledby="lightbox-title"
    onclick="closeLightbox(event)"
    tabindex="-1"
  >
    <div class="relative max-w-4xl max-h-[90vh] mx-4" onclick="event.stopPropagation()">
      <!-- Close Button -->
      <button
        onclick="closeLightbox()"
        aria-label="Close lightbox"
        class="absolute -top-12 right-0 text-white hover:text-slate-300 text-2xl font-bold transition-colors"
      >
        ×
      </button>
      
      <!-- Image -->
      <img 
        id="lightbox-img" 
        src="" 
        alt="" 
        class="max-w-full max-h-[90vh] object-contain rounded-lg"
        loading="eager"
        onerror="closeLightbox()"
      />
      
      <!-- Caption -->
      <p id="lightbox-title" class="text-white text-center mt-4 text-sm"></p>
    </div>
  </div>

  <script>
    function openLightbox(imageSrc, imageAlt) {
      const lightbox = document.getElementById('lightbox');
      const lightboxImg = document.getElementById('lightbox-img');
      const lightboxTitle = document.getElementById('lightbox-title');
      
      lightboxImg.src = imageSrc;
      lightboxImg.alt = imageAlt;
      lightboxTitle.textContent = imageAlt;
      lightbox.classList.remove('hidden');
      lightbox.classList.add('flex');
      document.body.style.overflow = 'hidden';
      lightbox.focus();
    }

    function closeLightbox(event) {
      // Only close if clicking backdrop or close button, not the image container
      if (event && event.target !== event.currentTarget && !event.target.closest('button')) {
        return;
      }
      
      const lightbox = document.getElementById('lightbox');
      lightbox.classList.add('hidden');
      lightbox.classList.remove('flex');
      document.body.style.overflow = '';
    }

    // Dropdown management utility
    (function() {
      const isMobile = window.matchMedia('(max-width: 768px)').matches && 'ontouchstart' in window && !window.matchMedia('(hover: hover)').matches;
      let hoverTimeout = null;
      const HOVER_DELAY = 150;

      function setupDropdown(dropdownId, buttonId, wrapperId) {
        const dropdown = document.getElementById(dropdownId);
        const button = document.getElementById(buttonId);
        const wrapper = document.getElementById(wrapperId);
        if (!dropdown || !button || !wrapper) {
            console.warn(\'Dropdown elements not found:\', { dropdownId, buttonId, wrapperId });
            return;
          }

                  let isOpen = false;
        let closeTimeout = null;

        const chevron = button.querySelector('svg');
        
        function openDropdown() {
          if (isOpen) return;
          clearTimeout(closeTimeout);
          dropdown.classList.remove('opacity-0', 'invisible', 'pointer-events-none', '-translate-y-2');
            dropdown.classList.add('opacity-100', 'visible', 'pointer-events-auto');
            dropdown.classList.remove('-translate-y-2');
            dropdown.classList.add('translate-y-0');
          button.setAttribute('aria-expanded', 'true');
          if (chevron) chevron.classList.add('rotate-180');
          isOpen = true;
          
          // Focus first item on keyboard open
          const firstItem = dropdown.querySelector('[role="menuitem"]');
          if (firstItem && document.activeElement === button) {
            setTimeout(() => firstItem.focus(), 0);
          }
        }

        function closeDropdown() {
          if (!isOpen) return;
          clearTimeout(closeTimeout);
          closeTimeout = setTimeout(() => {
            dropdown.classList.remove('opacity-100', 'visible', 'pointer-events-auto', 'translate-y-0');
              dropdown.classList.add('opacity-0', 'invisible', 'pointer-events-none', '-translate-y-2');
            button.setAttribute('aria-expanded', 'false');
            if (chevron) chevron.classList.remove('rotate-180');
            isOpen = false;
          }, 200);
        }

        function closeDropdownImmediate() {
          clearTimeout(closeTimeout);
          dropdown.classList.remove('opacity-100', 'visible', 'pointer-events-auto', 'translate-y-0');
              dropdown.classList.add('opacity-0', 'invisible', 'pointer-events-none', '-translate-y-2');
          button.setAttribute('aria-expanded', 'false');
          if (chevron) chevron.classList.remove('rotate-180');
          isOpen = false;
        }

        // Desktop: hover behavior (immediate show on hover)
            // Always enable hover on desktop, only disable on true mobile devices
            if (!isMobile || window.matchMedia('(hover: hover)').matches) {
              // Add hover to wrapper - this is the main trigger
              const handleWrapperEnter = () => {
                clearTimeout(closeTimeout);
                openDropdown();
              };
              wrapper.addEventListener('mouseenter', handleWrapperEnter);
              wrapper.addEventListener('mouseleave', closeDropdown);

              // Add hover to button as backup
              button.addEventListener('mouseenter', () => {
                clearTimeout(closeTimeout);
                openDropdown();
              });

              // Add hover to link (for News & Highlights)
              const link = wrapper.querySelector('a[href="/news-highlights.html"]');
              if (link) {
                link.addEventListener('mouseenter', () => {
                  clearTimeout(closeTimeout);
                  openDropdown();
                });
              }

              // Keep dropdown open when hovering over it
              dropdown.addEventListener('mouseenter', () => {
                clearTimeout(closeTimeout);
                // Ensure dropdown stays open
                if (!isOpen) {
                  openDropdown();
                }
              });

              dropdown.addEventListener('mouseleave', closeDropdown);
            }

        // Click to toggle (works on both desktop and mobile)
                        button.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              // Force open on click, even if hover already opened it
              if (isOpen) {
                closeDropdownImmediate();
              } else {
                // Close other dropdowns first
                document.querySelectorAll('[role="menu"]').forEach(menu => {
                  if (menu !== dropdown) {
                    menu.classList.remove('opacity-100', 'visible', 'pointer-events-auto', 'translate-y-0');
                    menu.classList.add('opacity-0', 'invisible', 'pointer-events-none', '-translate-y-2');
                    const otherButton = document.querySelector(`[aria-controls="${menu.id}"]`) || 
                                      document.querySelector(`button[aria-expanded="true"]`);
                    if (otherButton && otherButton !== button) {
                      otherButton.setAttribute('aria-expanded', 'false');
                      const otherChevron = otherButton.querySelector('svg');
                      if (otherChevron) otherChevron.classList.remove('rotate-180');
                    }
                  }
                });
                // Always open on click
                openDropdown();
              }
            }, true); // Use capture phase to ensure it fires"]`) || 
                                    document.querySelector(`button[aria-expanded="true"]`);
                  if (otherButton) {
                    otherButton.setAttribute('aria-expanded', 'false');
                    const otherChevron = otherButton.querySelector('svg');
                    if (otherChevron) otherChevron.classList.remove('rotate-180');
                  }
                }
              });
              openDropdown();
            }
          });
        }

        // Keyboard navigation
        button.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            if (isOpen) {
              closeDropdownImmediate();
            } else {
              openDropdown();
            }
          } else if (e.key === 'ArrowDown' && !isOpen) {
            e.preventDefault();
            openDropdown();
          }
        });

        // Keyboard navigation within dropdown
        const menuItems = dropdown.querySelectorAll('[role="menuitem"]');
        menuItems.forEach((item, index) => {
          item.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown') {
              e.preventDefault();
              const next = menuItems[index + 1] || menuItems[0];
              next?.focus();
            } else if (e.key === 'ArrowUp') {
              e.preventDefault();
              const prev = menuItems[index - 1] || menuItems[menuItems.length - 1];
              prev?.focus();
            } else if (e.key === 'Escape') {
              e.preventDefault();
              closeDropdownImmediate();
              button.focus();
            }
          });
        });

        // Focus management
        button.addEventListener('focus', () => {
          if (!isMobile) {
            openDropdown();
          }
        });

        button.addEventListener('blur', (e) => {
          clearTimeout(hoverTimeout);
          // Don't close if focus is moving to dropdown
          if (!dropdown.contains(e.relatedTarget)) {
            closeDropdown();
          }
        });

        // Close on outside click (mobile)
        if (isMobile) {
          document.addEventListener('click', (e) => {
            if (!wrapper.contains(e.target) && isOpen) {
              closeDropdownImmediate();
            }
          });
        }
      }
          // Initialize dropdowns
          setupDropdown('news-dropdown', 'news-dropdown-button', 'news-dropdown-wrapper');
      // Handle window resize
          let resizeTimer;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
          const newIsMobile = window.matchMedia('(max-width: 768px)').matches;
          if (newIsMobile !== isMobile) {
            location.reload(); // Simple approach: reload on breakpoint change
          }
        }, 250);
      });

      // ESC key to close all dropdowns
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          const lightbox = document.getElementById('lightbox');
          if (lightbox && !lightbox.classList.contains('hidden')) {
            closeLightbox();
          }
          document.querySelectorAll('[role="menu"]').forEach(menu => {
            menu.classList.add('hidden');
          });
          document.querySelectorAll('button[aria-expanded="true"]').forEach(btn => {
            btn.setAttribute('aria-expanded', 'false');
            const chev = btn.querySelector('svg');
            if (chev) chev.classList.remove('rotate-180');
          });
        }
      });
    })();

    // Mobile menu toggle (if exists)
    document.getElementById('mobile-menu-button')?.addEventListener('click', function() {
      const menu = document.getElementById('mobile-menu');
      const menuIcon = document.getElementById('menu-icon');
      const closeIcon = document.getElementById('close-icon');
      const isHidden = menu.classList.contains('hidden');
      
      if (isHidden) {
        menu.classList.remove('hidden');
        menuIcon?.classList.add('hidden');
        closeIcon?.classList.remove('hidden');
        this.setAttribute('aria-expanded', 'true');
      } else {
        menu.classList.add('hidden');
        menuIcon?.classList.remove('hidden');
        closeIcon?.classList.add('hidden');
        this.setAttribute('aria-expanded', 'false');
      }
    });
  </script>
</body>
</html>

